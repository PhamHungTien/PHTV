<Window x:Class="PHTV.UI.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="PHTV Preferences" Height="620" Width="820"
        WindowStartupLocation="CenterScreen" ResizeMode="CanResize"
        Background="#F3F3F3">
    <Grid Margin="16">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <TextBlock Text="PHTV Settings" FontSize="22" FontWeight="Bold" Foreground="#222" Margin="0,0,0,12"/>

        <TabControl Grid.Row="1">
            <!-- Typing -->
            <TabItem Header="Typing">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="12" Orientation="Vertical">
                        <GroupBox Header="Ngôn ngữ & Kiểu gõ" Padding="10" Margin="0,0,0,12">
                            <StackPanel>
                                <StackPanel Orientation="Horizontal" Margin="0,4,0,8">
                                    <TextBlock Text="Ngôn ngữ:" Width="120"/>
                                    <RadioButton x:Name="RadioLangVi" Content="Tiếng Việt" GroupName="Language" Checked="Language_Changed" Margin="0,0,16,0"/>
                                    <RadioButton x:Name="RadioLangEn" Content="English" GroupName="Language" Checked="Language_Changed"/>
                                </StackPanel>
                                <StackPanel Orientation="Horizontal" Margin="0,4,0,8">
                                    <TextBlock Text="Kiểu gõ:" Width="120"/>
                                    <RadioButton x:Name="RadioTelex" Content="Telex" GroupName="InputMethod" Checked="InputMethod_Changed" Margin="0,0,16,0"/>
                                    <RadioButton x:Name="RadioVNI" Content="VNI" GroupName="InputMethod" Checked="InputMethod_Changed"/>
                                </StackPanel>
                                <StackPanel Orientation="Horizontal" Margin="0,4,0,0">
                                    <TextBlock Text="Bảng mã:" Width="120"/>
                                    <ComboBox x:Name="ComboCodeTable" Width="220" SelectionChanged="CodeTable_Changed">
                                        <ComboBoxItem Content="Unicode" Tag="0"/>
                                        <ComboBoxItem Content="TCVN3 (ABC)" Tag="1"/>
                                        <ComboBoxItem Content="VNI Windows" Tag="2"/>
                                    </ComboBox>
                                </StackPanel>
                            </StackPanel>
                        </GroupBox>

                        <GroupBox Header="Tính năng gõ" Padding="10">
                            <StackPanel>
                                <CheckBox x:Name="ChkSpell" Content="Kiểm tra chính tả" Margin="0,4" Checked="Feature_Changed" Unchecked="Feature_Changed"/>
                                <CheckBox x:Name="ChkModern" Content="Dấu chuẩn (oà, uý)" Margin="0,4" Checked="Feature_Changed" Unchecked="Feature_Changed"/>
                                <CheckBox x:Name="ChkQuickTelex" Content="Gõ nhanh (Quick Telex)" Margin="0,4" Checked="Feature_Changed" Unchecked="Feature_Changed"/>
                                <CheckBox x:Name="ChkAutoRestoreEnglish" Content="Tự động khôi phục tiếng Anh" Margin="0,4" Checked="Feature_Changed" Unchecked="Feature_Changed"/>
                                <CheckBox x:Name="ChkUppercaseFirstChar" Content="Viết hoa ký tự đầu" Margin="0,4" Checked="Feature_Changed" Unchecked="Feature_Changed"/>
                                <CheckBox x:Name="ChkAllowConsonantZFWJ" Content="Cho phép phụ âm Z/F/W/J" Margin="0,4" Checked="Feature_Changed" Unchecked="Feature_Changed"/>
                                <CheckBox x:Name="ChkQuickStartConsonant" Content="Gõ nhanh phụ âm đầu" Margin="0,4" Checked="Feature_Changed" Unchecked="Feature_Changed"/>
                                <CheckBox x:Name="ChkQuickEndConsonant" Content="Gõ nhanh phụ âm cuối" Margin="0,4" Checked="Feature_Changed" Unchecked="Feature_Changed"/>
                                <CheckBox x:Name="ChkFreeMark" Content="Đặt dấu tự do" Margin="0,4" Checked="Feature_Changed" Unchecked="Feature_Changed"/>
                            </StackPanel>
                        </GroupBox>

                        <GroupBox Header="Ứng dụng không viết hoa ký tự đầu" Padding="10" Margin="0,12,0,0">
                            <StackPanel>
                                <StackPanel Orientation="Horizontal" Margin="0,4">
                                    <Button Content="Import" Width="90" Margin="0,0,8,0" Click="UpperExcludedImport_Click"/>
                                    <Button Content="Export" Width="90" Margin="0,0,8,0" Click="UpperExcludedExport_Click"/>
                                    <Button Content="Clear" Width="90" Margin="0,0,8,0" Click="UpperExcludedClear_Click"/>
                                    <Button Content="Detect Running Apps" Width="160" Click="UpperExcludedDetect_Click"/>
                                </StackPanel>
                                <StackPanel Orientation="Horizontal" Margin="0,4">
                                    <TextBox x:Name="TxtUpperExcludedName" Width="220" Margin="0,0,8,0" />
                                    <Button Content="Add" Width="80" Click="UpperExcludedAdd_Click"/>
                                </StackPanel>
                                <ListBox x:Name="UpperRunningAppList" Height="100" Margin="0,8,0,0" SelectionChanged="UpperRunning_Selected"/>
                                <DataGrid x:Name="UpperExcludedGrid" AutoGenerateColumns="False" CanUserAddRows="False" Margin="0,8,0,0" Height="200">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="App" Binding="{Binding Name}" Width="*"/>
                                        <DataGridTemplateColumn Header="" Width="80">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <Button Content="Remove" Tag="{Binding Name}" Click="UpperExcludedRemove_Click"/>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                        </DataGridTemplateColumn>
                                    </DataGrid.Columns>
                                </DataGrid>
                            </StackPanel>
                        </GroupBox>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!-- Hotkeys -->
            <TabItem Header="Hotkeys">
                <StackPanel Margin="12">
                    <GroupBox Header="Phím khôi phục" Padding="10" Margin="0,0,0,12">
                        <StackPanel>
                            <CheckBox x:Name="ChkRestoreOnEscape" Content="Khôi phục bằng phím Escape" Margin="0,4" Checked="Hotkey_Changed" Unchecked="Hotkey_Changed"/>
                            <StackPanel Orientation="Horizontal" Margin="0,4,0,0">
                                <TextBlock Text="Custom Escape Key:" Width="160"/>
                                <TextBox x:Name="TxtCustomEscapeKey" Width="180" IsReadOnly="True" PreviewKeyDown="Hotkey_CaptureKey"/>
                                <Button Content="Record" Width="80" Margin="8,0,0,0" Click="Hotkey_RecordEscape_Click"/>
                            </StackPanel>
                        </StackPanel>
                    </GroupBox>

                    <GroupBox Header="Pause Key" Padding="10">
                        <StackPanel>
                            <CheckBox x:Name="ChkPauseKeyEnabled" Content="Bật phím Pause" Margin="0,4" Checked="Hotkey_Changed" Unchecked="Hotkey_Changed"/>
                            <StackPanel Orientation="Horizontal" Margin="0,4,0,0">
                                <TextBlock Text="Pause Key (VK):" Width="160"/>
                                <TextBox x:Name="TxtPauseKey" Width="180" IsReadOnly="True" PreviewKeyDown="Hotkey_CaptureKey"/>
                                <Button Content="Record" Width="80" Margin="8,0,0,0" Click="Hotkey_RecordPause_Click"/>
                            </StackPanel>
                        </StackPanel>
                    </GroupBox>

                    <GroupBox Header="Phím chuyển ngôn ngữ" Padding="10" Margin="0,12,0,0">
                        <StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="0,4">
                                <CheckBox x:Name="ChkSwitchCtrl" Content="Ctrl" Margin="0,0,12,0" Checked="SwitchHotkey_Changed" Unchecked="SwitchHotkey_Changed"/>
                                <CheckBox x:Name="ChkSwitchAlt" Content="Alt" Margin="0,0,12,0" Checked="SwitchHotkey_Changed" Unchecked="SwitchHotkey_Changed"/>
                                <CheckBox x:Name="ChkSwitchShift" Content="Shift" Margin="0,0,12,0" Checked="SwitchHotkey_Changed" Unchecked="SwitchHotkey_Changed"/>
                                <CheckBox x:Name="ChkSwitchWin" Content="Win" Checked="SwitchHotkey_Changed" Unchecked="SwitchHotkey_Changed"/>
                            </StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="0,4,0,0">
                                <TextBlock Text="Switch Key:" Width="160"/>
                                <TextBox x:Name="TxtSwitchKey" Width="180" IsReadOnly="True" PreviewKeyDown="SwitchKey_CaptureKey"/>
                                <Button Content="Record" Width="80" Margin="8,0,0,0" Click="SwitchKey_Record_Click"/>
                                <Button Content="No Key" Width="80" Margin="8,0,0,0" Click="SwitchKey_NoKey_Click"/>
                            </StackPanel>
                            <CheckBox x:Name="ChkSwitchBeep" Content="Beep khi đổi chế độ" Margin="0,4" Checked="SwitchHotkey_Changed" Unchecked="SwitchHotkey_Changed"/>
                        </StackPanel>
                    </GroupBox>
                </StackPanel>
            </TabItem>

            <!-- Macro -->
            <TabItem Header="Macro">
                <StackPanel Margin="12">
                    <GroupBox Header="Macro" Padding="10">
                        <StackPanel>
                            <CheckBox x:Name="ChkMacro" Content="Bật gõ tắt (Macro)" Margin="0,4" Checked="Feature_Changed" Unchecked="Feature_Changed"/>
                            <CheckBox x:Name="ChkMacroInEnglish" Content="Macro trong chế độ English" Margin="0,4" Checked="Feature_Changed" Unchecked="Feature_Changed"/>
                            <CheckBox x:Name="ChkAutoCapsMacro" Content="Tự viết hoa Macro" Margin="0,4" Checked="Feature_Changed" Unchecked="Feature_Changed"/>
                            <Separator Margin="0,8,0,8"/>
                            <StackPanel Orientation="Horizontal" Margin="0,4">
                                <Button Content="Import" Width="90" Margin="0,0,8,0" Click="MacroImport_Click"/>
                                <Button Content="Export" Width="90" Margin="0,0,8,0" Click="MacroExport_Click"/>
                                <Button Content="Clear" Width="90" Click="MacroClear_Click"/>
                            </StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="0,4">
                                <TextBox x:Name="TxtMacroKey" Width="140" Margin="0,0,8,0" />
                                <TextBox x:Name="TxtMacroValue" Width="360" Margin="0,0,8,0" />
                                <Button Content="Add" Width="80" Click="MacroAdd_Click"/>
                            </StackPanel>
                            <DataGrid x:Name="MacroGrid" AutoGenerateColumns="False" CanUserAddRows="False" Margin="0,8,0,0" Height="240">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="Key" Binding="{Binding Key}" Width="120"/>
                                    <DataGridTextColumn Header="Content" Binding="{Binding Value}" Width="*"/>
                                    <DataGridTemplateColumn Header="" Width="80">
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <Button Content="Remove" Tag="{Binding Key}" Click="MacroRemove_Click"/>
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>
                                </DataGrid.Columns>
                            </DataGrid>
                        </StackPanel>
                    </GroupBox>
                </StackPanel>
            </TabItem>

            <!-- Apps -->
            <TabItem Header="Apps">
                <StackPanel Margin="12">
                    <GroupBox Header="Ứng dụng" Padding="10">
                        <StackPanel>
                            <CheckBox x:Name="ChkSmartSwitchKey" Content="Ghi nhớ kiểu gõ theo ứng dụng" Margin="0,4" Checked="Feature_Changed" Unchecked="Feature_Changed"/>
                            <Separator Margin="0,8,0,8"/>
                            <StackPanel Orientation="Horizontal" Margin="0,4">
                                <Button Content="Import" Width="90" Margin="0,0,8,0" Click="AppImport_Click"/>
                                <Button Content="Export" Width="90" Margin="0,0,8,0" Click="AppExport_Click"/>
                                <Button Content="Detect Running Apps" Width="160" Click="AppDetect_Click"/>
                            </StackPanel>
                            <StackPanel Orientation="Horizontal" Margin="0,4">
                                <TextBox x:Name="TxtAppName" Width="220" Margin="0,0,8,0" />
                                <ComboBox x:Name="ComboAppLanguage" Width="160" Margin="0,0,8,0">
                                    <ComboBoxItem Content="Tiếng Việt" Tag="1"/>
                                    <ComboBoxItem Content="English" Tag="0"/>
                                </ComboBox>
                                <Button Content="Add/Update" Width="100" Click="AppAdd_Click"/>
                            </StackPanel>
                            <ListBox x:Name="RunningAppList" Height="120" Margin="0,8,0,0" SelectionChanged="AppRunning_Selected"/>
                            <DataGrid x:Name="AppGrid" AutoGenerateColumns="False" CanUserAddRows="False" Margin="0,8,0,0" Height="220">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="App" Binding="{Binding Name}" Width="*"/>
                                    <DataGridTextColumn Header="Language" Binding="{Binding LanguageName}" Width="160"/>
                                    <DataGridTemplateColumn Header="" Width="80">
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <Button Content="Remove" Tag="{Binding Name}" Click="AppRemove_Click"/>
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>
                                </DataGrid.Columns>
                            </DataGrid>
                        </StackPanel>
                    </GroupBox>
                </StackPanel>
            </TabItem>

            <!-- System -->
            <TabItem Header="System">
                <StackPanel Margin="12">
                    <GroupBox Header="Hệ thống" Padding="10">
                        <StackPanel>
                            <CheckBox x:Name="ChkFixRecommendBrowser" Content="Fix recommend browser/Excel" Margin="0,4" Checked="Feature_Changed" Unchecked="Feature_Changed"/>
                            <CheckBox x:Name="ChkOtherLanguage" Content="Tắt tiếng Việt khi gõ ngôn ngữ khác" Margin="0,4" Checked="System_Changed" Unchecked="System_Changed"/>
                            <TextBlock Text="Tùy chọn nâng cao khác sẽ được bổ sung sau." Foreground="#666" Margin="0,6,0,0"/>
                        </StackPanel>
                    </GroupBox>
                </StackPanel>
            </TabItem>
        </TabControl>

        <StackPanel Grid.Row="2" Orientation="Horizontal" HorizontalAlignment="Right" Margin="0,12,0,0">
            <Button Content="Reset" Width="90" Margin="0,0,8,0" Click="Reset_Click"/>
            <Button Content="Đóng" Width="90" Click="Close_Click"/>
        </StackPanel>
    </Grid>
</Window>

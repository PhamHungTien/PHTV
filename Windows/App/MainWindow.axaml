<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:PHTV.Windows.ViewModels"
        xmlns:tabs="using:PHTV.Windows.Views.Tabs"
        x:Class="PHTV.Windows.MainWindow"
        Title="PHTV - Bộ gõ tiếng Việt"
        Width="1180"
        Height="760"
        MinWidth="980"
        MinHeight="620"
        Icon="/Assets/PHTV.ico"
        TransparencyLevelHint="Mica"
        Background="Transparent"
        ExtendClientAreaToDecorationsHint="True">

  <Grid ColumnDefinitions="280,*">
    <!-- Sidebar -->
    <Border Grid.Column="0" 
            Classes="sidebar-panel" 
            PointerPressed="OnPointerPressed">
      <DockPanel LastChildFill="True">
        <StackPanel DockPanel.Dock="Top" Margin="16,54,16,16" Spacing="16">
          <Grid ColumnDefinitions="Auto,*">
            <Border Classes="sidebar-brand-icon">
              <Image Source="/Assets/icon.png" Width="26" Height="26" Stretch="Uniform"/>
            </Border>
            <StackPanel Grid.Column="1" Margin="12,0,0,0" Spacing="0" VerticalAlignment="Center">
              <TextBlock Classes="sidebar-title" Text="PHTV"/>
              <TextBlock Classes="sidebar-subtitle" Text="Precision Hybrid Typing Vietnamese"/>
            </StackPanel>
          </Grid>
          <TextBox Watermark="Tìm kiếm cài đặt..." 
                   Classes="sidebar-search"
                   Text="{Binding SearchText, UpdateSourceTrigger=PropertyChanged}"/>
        </StackPanel>

        <ScrollViewer VerticalScrollBarVisibility="Auto">
          <ItemsControl ItemsSource="{Binding SidebarEntries}" Margin="0,0,0,16">
            <ItemsControl.DataTemplates>
              <DataTemplate DataType="vm:SidebarSectionEntry">
                <TextBlock Text="{Binding Title}" Classes="sidebar-section-title" Margin="24,16,16,8"/>
              </DataTemplate>

              <DataTemplate DataType="vm:SidebarTabEntry">
                <Button Classes="sidebar-tab"
                        Classes.selected="{Binding IsSelected}"
                        Command="{Binding DataContext.SelectTabCommand, RelativeSource={RelativeSource AncestorType=Window}}"
                        CommandParameter="{Binding TabId}"
                        Margin="12,2">
                  <Grid ColumnDefinitions="32,*" VerticalAlignment="Center">
                    <Border Classes="sidebar-icon">
                      <TextBlock Text="{Binding IconGlyph}" Classes="sidebar-icon-text"/>
                    </Border>
                    <TextBlock Grid.Column="1" Text="{Binding Title}" 
                               VerticalAlignment="Center" 
                               Margin="10,0,0,0"
                               FontSize="13"
                               FontWeight="Medium"/>
                  </Grid>
                </Button>
              </DataTemplate>
            </ItemsControl.DataTemplates>
          </ItemsControl>
        </ScrollViewer>
      </DockPanel>
    </Border>

    <!-- Content Area -->
    <Border Grid.Column="1" 
            Classes="detail-panel"
            PointerPressed="OnPointerPressed">
      <ContentControl Content="{Binding CurrentTab}">
        <ContentControl.DataTemplates>
          <DataTemplate DataType="vm:TypingTabViewModel">
            <tabs:TypingTabView/>
          </DataTemplate>
          <DataTemplate DataType="vm:HotkeysTabViewModel">
            <tabs:HotkeysTabView/>
          </DataTemplate>
          <DataTemplate DataType="vm:MacroTabViewModel">
            <tabs:MacroTabView/>
          </DataTemplate>
          <DataTemplate DataType="vm:AppsTabViewModel">
            <tabs:AppsTabView/>
          </DataTemplate>
          <DataTemplate DataType="vm:SystemTabViewModel">
            <tabs:SystemTabView/>
          </DataTemplate>
          <DataTemplate DataType="vm:BugReportTabViewModel">
            <tabs:BugReportTabView/>
          </DataTemplate>
          <DataTemplate DataType="vm:AboutTabViewModel">
            <tabs:AboutTabView/>
          </DataTemplate>
        </ContentControl.DataTemplates>
      </ContentControl>
    </Border>
  </Grid>
</Window>

<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:vm="using:PHTV.Windows.ViewModels"
             x:Class="PHTV.Windows.Views.Tabs.HotkeysTabView"
             x:DataType="vm:HotkeysTabViewModel">
  <ScrollViewer VerticalScrollBarVisibility="Auto">
    <StackPanel Margin="32,54,32,32" Spacing="20" MaxWidth="760">
      <Border Classes="settings-header">
        <Grid ColumnDefinitions="*,Auto">
          <StackPanel Spacing="4">
            <TextBlock Classes="settings-header-title" Text="{Binding Title}"/>
            <TextBlock Classes="settings-header-subtitle" Text="{Binding Subtitle}" TextWrapping="Wrap"/>
          </StackPanel>
          <Border Grid.Column="1" Classes="status-pill">
            <TextBlock Classes="status-pill-text" Text="{Binding State.SwitchHotkeyDisplay, StringFormat='Chuyển chế độ: {0}'}"/>
          </Border>
        </Grid>
      </Border>

      <Border Classes="settings-card">
        <StackPanel>
          <Border Classes="settings-card-header">
            <Grid ColumnDefinitions="40,*">
              <Border Classes="settings-card-icon"><TextBlock Classes="settings-card-icon-text" Text="⌘"/></Border>
              <StackPanel Grid.Column="1" Spacing="2">
                <TextBlock Classes="settings-card-title" Text="Chuyển chế độ gõ"/>
                <TextBlock Classes="settings-card-subtitle" Text="Thiết lập phím tắt nhanh theo kiểu macOS"/>
              </StackPanel>
            </Grid>
          </Border>

          <StackPanel Margin="16" Spacing="12">
            <StackPanel Spacing="6">
              <TextBlock Classes="settings-row-title" Text="Phím bổ trợ"/>
              <WrapPanel>
                <ToggleButton Classes="hotkey-chip" Content="Ctrl" Margin="0,0,8,8" IsChecked="{Binding State.SwitchHotkeyControl}"/>
                <ToggleButton Classes="hotkey-chip" Content="Shift" Margin="0,0,8,8" IsChecked="{Binding State.SwitchHotkeyShift}"/>
                <ToggleButton Classes="hotkey-chip" Content="Alt" Margin="0,0,8,8" IsChecked="{Binding State.SwitchHotkeyOption}"/>
                <ToggleButton Classes="hotkey-chip" Content="Win" Margin="0,0,8,8" IsChecked="{Binding State.SwitchHotkeyCommand}"/>
                <ToggleButton Classes="hotkey-chip" Content="Fn" Margin="0,0,8,8" IsChecked="{Binding State.SwitchHotkeyFn}"/>
              </WrapPanel>
              <TextBlock Classes="hotkey-hint" Text="Mặc định: Ctrl + Shift (nhấn rồi thả để chuyển ngôn ngữ)."/>
            </StackPanel>

            <Border Classes="settings-divider"/>

            <Grid ColumnDefinitions="*,220" VerticalAlignment="Center">
              <StackPanel Spacing="2">
                <TextBlock Classes="settings-row-title" Text="Phím chính (tùy chọn)"/>
                <TextBlock Classes="settings-row-subtitle" Text="Có thể để 'Không' để dùng chế độ chỉ modifier"/>
              </StackPanel>
              <ComboBox Grid.Column="1"
                        Classes="hotkey-primary-selector"
                        ItemsSource="{Binding State.SwitchHotkeyPrimaryOptions}"
                        SelectedItem="{Binding State.SwitchHotkeyPrimary}"/>
            </Grid>

            <Border Classes="hotkey-preview">
              <StackPanel Spacing="2">
                <TextBlock Classes="hotkey-preview-label" Text="Tổ hợp hiện tại"/>
                <TextBlock Classes="hotkey-preview-value" Text="{Binding State.SwitchHotkeyDisplay}"/>
              </StackPanel>
            </Border>
          </StackPanel>
        </StackPanel>
      </Border>

      <Border Classes="settings-card">
        <StackPanel>
          <Border Classes="settings-card-header">
            <Grid ColumnDefinitions="40,*">
              <Border Classes="settings-card-icon"><TextBlock Classes="settings-card-icon-text" Text="↶"/></Border>
              <StackPanel Grid.Column="1" Spacing="2">
                <TextBlock Classes="settings-card-title" Text="Khôi phục ký tự"/>
                <TextBlock Classes="settings-card-subtitle" Text="Hoàn tác nhanh khi gõ sai"/>
              </StackPanel>
            </Grid>
          </Border>

          <StackPanel Margin="16" Spacing="8">
            <Grid ColumnDefinitions="*,Auto">
              <StackPanel Spacing="2">
                <TextBlock Classes="settings-row-title" Text="Hoàn tác về ký tự gốc"/>
                <TextBlock Classes="settings-row-subtitle" Text="Dùng phím hoàn tác để trả về ký tự trước khi biến đổi"/>
              </StackPanel>
              <ToggleSwitch Grid.Column="1" IsChecked="{Binding State.RestoreOnEscape}"/>
            </Grid>
            <Border Classes="settings-divider"/>
            <StackPanel Spacing="6" IsVisible="{Binding State.RestoreOnEscape}">
              <TextBlock Classes="settings-row-title" Text="Chọn phím hoàn tác"/>
              <WrapPanel>
                <ToggleButton Classes="hotkey-chip"
                              Content="ESC"
                              Margin="0,0,8,8"
                              IsChecked="{Binding State.RestoreKeyEscSelected}"/>
                <ToggleButton Classes="hotkey-chip"
                              Content="Option"
                              Margin="0,0,8,8"
                              IsChecked="{Binding State.RestoreKeyOptionSelected}"/>
                <ToggleButton Classes="hotkey-chip"
                              Content="Control"
                              Margin="0,0,8,8"
                              IsChecked="{Binding State.RestoreKeyControlSelected}"/>
              </WrapPanel>
              <TextBlock Classes="hotkey-hint" Text="Hoạt động như radio: luôn giữ 1 phím hoàn tác được chọn."/>
            </StackPanel>
          </StackPanel>
        </StackPanel>
      </Border>

      <Border Classes="settings-card">
        <StackPanel>
          <Border Classes="settings-card-header">
            <Grid ColumnDefinitions="40,*">
              <Border Classes="settings-card-icon"><TextBlock Classes="settings-card-icon-text" Text="⏸"/></Border>
              <StackPanel Grid.Column="1" Spacing="2">
                <TextBlock Classes="settings-card-title" Text="Tạm dừng gõ tiếng Việt"/>
                <TextBlock Classes="settings-card-subtitle" Text="Tạm ngưng bộ gõ khi cần nhập liệu đặc biệt"/>
              </StackPanel>
            </Grid>
          </Border>

          <StackPanel Margin="16" Spacing="8">
            <Grid ColumnDefinitions="*,Auto">
              <StackPanel Spacing="2">
                <TextBlock Classes="settings-row-title" Text="Bật phím tạm dừng"/>
                <TextBlock Classes="settings-row-subtitle" Text="Giữ phím để tạm chuyển sang English"/>
              </StackPanel>
              <ToggleSwitch Grid.Column="1" IsChecked="{Binding State.PauseKeyEnabled}"/>
            </Grid>
            <Border Classes="settings-divider"/>
            <StackPanel Spacing="6" IsVisible="{Binding State.PauseKeyEnabled}">
              <TextBlock Classes="settings-row-title" Text="Phím tạm dừng"/>
              <WrapPanel>
                <ToggleButton Classes="hotkey-chip"
                              Content="Option"
                              Margin="0,0,8,8"
                              IsChecked="{Binding State.PauseKeyAltSelected}"/>
                <ToggleButton Classes="hotkey-chip"
                              Content="Control"
                              Margin="0,0,8,8"
                              IsChecked="{Binding State.PauseKeyControlSelected}"/>
                <ToggleButton Classes="hotkey-chip"
                              Content="Shift"
                              Margin="0,0,8,8"
                              IsChecked="{Binding State.PauseKeyShiftSelected}"/>
              </WrapPanel>
              <TextBlock Classes="hotkey-hint" Text="Giữ một trong các phím trên để tạm thời gõ tiếng Anh."/>
            </StackPanel>
          </StackPanel>
        </StackPanel>
      </Border>

      <Border Classes="settings-card">
        <StackPanel>
          <Border Classes="settings-card-header">
            <Grid ColumnDefinitions="40,*">
              <Border Classes="settings-card-icon"><TextBlock Classes="settings-card-icon-text" Text="☺"/></Border>
              <StackPanel Grid.Column="1" Spacing="2">
                <TextBlock Classes="settings-card-title" Text="PHTV Picker"/>
                <TextBlock Classes="settings-card-subtitle" Text="Mở nhanh bảng emoji/sticker/GIF"/>
              </StackPanel>
            </Grid>
          </Border>

          <StackPanel Margin="16" Spacing="8">
            <Grid ColumnDefinitions="*,Auto">
              <StackPanel Spacing="2">
                <TextBlock Classes="settings-row-title" Text="Bật hotkey PHTV Picker"/>
                <TextBlock Classes="settings-row-subtitle" Text="Mở nhanh picker trong mọi ứng dụng"/>
              </StackPanel>
              <ToggleSwitch Grid.Column="1" IsChecked="{Binding State.EmojiHotkeyEnabled}"/>
            </Grid>

            <StackPanel IsVisible="{Binding State.EmojiHotkeyEnabled}" Spacing="12">
              <Border Classes="settings-divider"/>

              <StackPanel Spacing="6">
                <TextBlock Classes="settings-row-title" Text="Phím bổ trợ"/>
                <WrapPanel>
                  <ToggleButton Classes="hotkey-chip" Content="Ctrl" Margin="0,0,8,8" IsChecked="{Binding State.EmojiHotkeyControl}"/>
                  <ToggleButton Classes="hotkey-chip" Content="Shift" Margin="0,0,8,8" IsChecked="{Binding State.EmojiHotkeyShift}"/>
                  <ToggleButton Classes="hotkey-chip" Content="Alt" Margin="0,0,8,8" IsChecked="{Binding State.EmojiHotkeyOption}"/>
                  <ToggleButton Classes="hotkey-chip" Content="Win" Margin="0,0,8,8" IsChecked="{Binding State.EmojiHotkeyCommand}"/>
                  <ToggleButton Classes="hotkey-chip" Content="Fn" Margin="0,0,8,8" IsChecked="{Binding State.EmojiHotkeyFn}"/>
                </WrapPanel>
              </StackPanel>

              <Grid ColumnDefinitions="*,220" VerticalAlignment="Center">
                <StackPanel Spacing="2">
                  <TextBlock Classes="settings-row-title" Text="Phím chính"/>
                  <TextBlock Classes="settings-row-subtitle" Text="Mặc định: E"/>
                </StackPanel>
                <ComboBox Grid.Column="1"
                          Classes="hotkey-primary-selector"
                          ItemsSource="{Binding State.EmojiHotkeyPrimaryOptions}"
                          SelectedItem="{Binding State.EmojiHotkeyPrimary}"/>
              </Grid>

              <Border Classes="hotkey-preview">
                <StackPanel Spacing="2">
                  <TextBlock Classes="hotkey-preview-label" Text="Tổ hợp hiện tại"/>
                  <TextBlock Classes="hotkey-preview-value" Text="{Binding State.EmojiHotkeyDisplay}"/>
                </StackPanel>
              </Border>
            </StackPanel>
          </StackPanel>
        </StackPanel>
      </Border>
    </StackPanel>
  </ScrollViewer>
</UserControl>

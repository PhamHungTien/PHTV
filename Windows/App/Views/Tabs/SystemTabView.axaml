<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             x:Class="PHTV.Windows.Views.Tabs.SystemTabView"
             xmlns:vm="using:PHTV.Windows.ViewModels"
             x:DataType="vm:SystemTabViewModel">
  <ScrollViewer VerticalScrollBarVisibility="Auto">
    <StackPanel Margin="32,54,32,32" Spacing="20" MaxWidth="760">
      <Border Classes="settings-header">
        <Grid ColumnDefinitions="*,Auto">
          <StackPanel Spacing="4">
            <TextBlock Classes="settings-header-title" Text="{Binding Title}"/>
            <TextBlock Classes="settings-header-subtitle" Text="{Binding Subtitle}" TextWrapping="Wrap"/>
          </StackPanel>
          <StackPanel Grid.Column="1" Spacing="6" HorizontalAlignment="Right" VerticalAlignment="Center">
            <Border Classes="status-pill"><TextBlock Classes="status-pill-text" Text="{Binding State.RunOnStartup, StringFormat='Tự khởi động: {0}'}"/></Border>
            <Border Classes="status-pill"><TextBlock Classes="status-pill-text" Text="{Binding State.ShowSettingsOnStartup, StringFormat='Mở cài đặt khi khởi động: {0}'}"/></Border>
            <Border Classes="status-pill"><TextBlock Classes="status-pill-text" Text="{Binding State.ShowIconOnDock, StringFormat='Dock: {0}'}"/></Border>
          </StackPanel>
        </Grid>
      </Border>

      <!-- Startup -->
      <Border Classes="settings-card">
        <StackPanel>
          <Border Classes="settings-card-header orange">
            <Grid ColumnDefinitions="40,*">
              <Border Classes="settings-card-icon"><TextBlock Classes="settings-card-icon-text" Text="⏻"/></Border>
              <StackPanel Grid.Column="1" Spacing="2"><TextBlock Classes="settings-card-title" Text="Khởi động cùng hệ thống"/><TextBlock Classes="settings-card-subtitle" Text="Tự mở PHTV khi đăng nhập Windows"/></StackPanel>
            </Grid>
          </Border>
          <StackPanel Margin="16" Spacing="8">
            <Grid ColumnDefinitions="*,Auto"><StackPanel Spacing="2"><TextBlock Classes="settings-row-title" Text="Bật khởi động cùng Windows"/><TextBlock Classes="settings-row-subtitle" Text="Đăng ký startup qua user registry (HKCU)"/></StackPanel><ToggleSwitch Grid.Column="1" IsChecked="{Binding State.RunOnStartup}"/></Grid>
            <Border Classes="settings-divider"/>
            <Grid ColumnDefinitions="*,Auto"><StackPanel Spacing="2"><TextBlock Classes="settings-row-title" Text="Mở cửa sổ cài đặt khi khởi động"/><TextBlock Classes="settings-row-subtitle" Text="Nếu tắt, app sẽ chạy nền ở tray khi auto-start"/></StackPanel><ToggleSwitch Grid.Column="1" IsChecked="{Binding State.ShowSettingsOnStartup}"/></Grid>
          </StackPanel>
        </StackPanel>
      </Border>

      <!-- Interface -->
      <Border Classes="settings-card">
        <StackPanel>
          <Border Classes="settings-card-header orange">
            <Grid ColumnDefinitions="40,*">
              <Border Classes="settings-card-icon"><TextBlock Classes="settings-card-icon-text" Text="◧"/></Border>
              <StackPanel Grid.Column="1" Spacing="2"><TextBlock Classes="settings-card-title" Text="Giao diện"/><TextBlock Classes="settings-card-subtitle" Text="Tùy chỉnh hiển thị cửa sổ"/></StackPanel>
            </Grid>
          </Border>
          <StackPanel Margin="16" Spacing="8">
            <Grid ColumnDefinitions="*,Auto"><StackPanel Spacing="2"><TextBlock Classes="settings-row-title" Text="Cài đặt luôn ở trên"/><TextBlock Classes="settings-row-subtitle" Text="Giữ cửa sổ Cài đặt nằm trên app khác"/></StackPanel><ToggleSwitch Grid.Column="1" IsChecked="{Binding State.SettingsWindowAlwaysOnTop}"/></Grid>
          </StackPanel>
        </StackPanel>
      </Border>

      <!-- Menu Bar Icon -->
      <Border Classes="settings-card">
        <StackPanel>
          <Border Classes="settings-card-header orange">
            <Grid ColumnDefinitions="40,*">
              <Border Classes="settings-card-icon"><TextBlock Classes="settings-card-icon-text" Text="▭"/></Border>
              <StackPanel Grid.Column="1" Spacing="2"><TextBlock Classes="settings-card-title" Text="Thanh menu"/><TextBlock Classes="settings-card-subtitle" Text="Tùy chỉnh biểu tượng trạng thái"/></StackPanel>
            </Grid>
          </Border>
          <StackPanel Margin="16" Spacing="8">
            <Grid ColumnDefinitions="*,Auto"><StackPanel Spacing="2"><TextBlock Classes="settings-row-title" Text="Hiển thị biểu tượng chữ V"/><TextBlock Classes="settings-row-subtitle" Text="Dùng icon chữ V khi ở chế độ Việt"/></StackPanel><ToggleSwitch Grid.Column="1" IsChecked="{Binding State.UseVietnameseMenubarIcon}"/></Grid>
          </StackPanel>
        </StackPanel>
      </Border>

      <!-- Update -->
      <Border Classes="settings-card">
        <StackPanel>
          <Border Classes="settings-card-header orange">
            <Grid ColumnDefinitions="40,*">
              <Border Classes="settings-card-icon"><TextBlock Classes="settings-card-icon-text" Text="⬇"/></Border>
              <StackPanel Grid.Column="1" Spacing="2"><TextBlock Classes="settings-card-title" Text="Cập nhật"/><TextBlock Classes="settings-card-subtitle" Text="Thiết lập kiểm tra và cài đặt cập nhật"/></StackPanel>
            </Grid>
          </Border>
          <StackPanel Margin="16" Spacing="12">
            <Grid ColumnDefinitions="*,220"><StackPanel Spacing="2"><TextBlock Classes="settings-row-title" Text="Tần suất kiểm tra cập nhật"/><TextBlock Classes="settings-row-subtitle" Text="Tự động kiểm tra bản mới"/></StackPanel><ComboBox Grid.Column="1" HorizontalAlignment="Stretch" ItemsSource="{Binding State.UpdateCheckFrequencyOptions}" SelectedItem="{Binding State.UpdateCheckFrequency}"/></Grid>
            <Border Classes="settings-divider"/>
            <Grid ColumnDefinitions="*,Auto"><StackPanel Spacing="2"><TextBlock Classes="settings-row-title" Text="Tự động cài đặt cập nhật"/><TextBlock Classes="settings-row-subtitle" Text="Cài đặt khi có phiên bản mới"/></StackPanel><ToggleSwitch Grid.Column="1" IsChecked="{Binding State.AutoInstallUpdates}"/></Grid>
            <Border Classes="settings-divider"/>
            <Grid ColumnDefinitions="*,Auto"><StackPanel Spacing="2"><TextBlock Classes="settings-row-title" Text="Kênh beta"/><TextBlock Classes="settings-row-subtitle" Text="Nhận bản thử nghiệm"/></StackPanel><ToggleSwitch Grid.Column="1" IsChecked="{Binding State.BetaChannelEnabled}"/></Grid>
            <Border Classes="settings-divider"/>
            <Button HorizontalAlignment="Left" Content="Kiểm tra cập nhật ngay" Command="{Binding DataContext.CheckForUpdatesCommand, RelativeSource={RelativeSource AncestorType=Window}}"/>
          </StackPanel>
        </StackPanel>
      </Border>

      <!-- Data & Backup -->
      <Border Classes="settings-card">
        <StackPanel>
          <Border Classes="settings-card-header orange">
            <Grid ColumnDefinitions="40,*">
              <Border Classes="settings-card-icon"><TextBlock Classes="settings-card-icon-text" Text="▦"/></Border>
              <StackPanel Grid.Column="1" Spacing="2"><TextBlock Classes="settings-card-title" Text="Dữ liệu &amp; sao lưu"/><TextBlock Classes="settings-card-subtitle" Text="Sao lưu, khôi phục và đặt lại"/></StackPanel>
            </Grid>
          </Border>
          <StackPanel Margin="16" Spacing="12">
            <TextBlock Text="Nếu PHTV hữu ích, bạn có thể xem hướng dẫn hoặc quản lý dữ liệu cài đặt của mình tại đây." FontSize="13" Foreground="{DynamicResource PhtvTextSecondaryBrush}" TextWrapping="Wrap"/>
            <UniformGrid Columns="2" Rows="2">
              <Button HorizontalAlignment="Stretch" HorizontalContentAlignment="Center" Margin="0,0,4,4" Content="Xem hướng dẫn" Command="{Binding DataContext.OpenGuideCommand, RelativeSource={RelativeSource AncestorType=Window}}"/>
              <Button HorizontalAlignment="Stretch" HorizontalContentAlignment="Center" Margin="4,0,0,4" Content="Xuất cấu hình" Command="{Binding DataContext.ExportSettingsCommand, RelativeSource={RelativeSource AncestorType=Window}}"/>
              <Button HorizontalAlignment="Stretch" HorizontalContentAlignment="Center" Margin="0,4,4,0" Content="Nhập cấu hình" Command="{Binding DataContext.ImportSettingsCommand, RelativeSource={RelativeSource AncestorType=Window}}"/>
              <Button HorizontalAlignment="Stretch" HorizontalContentAlignment="Center" Margin="4,4,0,0" Content="Khôi phục mặc định" Command="{Binding DataContext.ResetSettingsCommand, RelativeSource={RelativeSource AncestorType=Window}}"/>
            </UniformGrid>
          </StackPanel>
        </StackPanel>
      </Border>
    </StackPanel>
  </ScrollViewer>
</UserControl>
